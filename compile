#!/bin/sh

SCRIPT_ROOT=`dirname "${0}"`
cd "${SCRIPT_ROOT}"

RESOURCES_DIR="DwarfBuilder.app/Contents/Resources"
DT_INI_DIR="Contents/MacOS/etc/memory_layouts/osx"

echo ""
echo "Creating a new Builder"

cp -rp extras/DwarfBuilder.app .
mkdir "${RESOURCES_DIR}"

echo "Populating materials..."
cp -rp extras "${RESOURCES_DIR}"
cp -p menu "${RESOURCES_DIR}"
cp -p extras/memory_layouts/* "${RESOURCES_DIR}/extras/DwarfTherapist.app/${DT_INI_DIR}/"

echo "Adding tilesets..."
cp -rp ironhand "${RESOURCES_DIR}"
cp -rp jolly "${RESOURCES_DIR}"
cp -rp mayday "${RESOURCES_DIR}"
cp -rp phoebus "${RESOURCES_DIR}"

echo "Reticulating splines"
cp -rp vanilla "${RESOURCES_DIR}"

echo "Cleaning up..."

rm -rf "${RESOURCES_DIR}/extras/DwarfBuilder.app"
rm -rf "${RESOURCES_DIR}/extras/memory_layouts"

echo ""
echo "Finished! Don't forget to follow the checklist:"
echo "1) Check app and executable icons."
echo "2) Clean up .DS_Store, .git files."
echo "3) Update instructions, then convert to PDF."
echo "4) Zip up the app and the PDF."
